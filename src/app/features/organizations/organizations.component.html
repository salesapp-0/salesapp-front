<app-header></app-header>
<div class="flex">
  <app-sidebar/>
<div class="wrapper">
  <div class="organizations">
    <div class="organizations__header">
      <h2>ორგანიზაციების ცხრილი</h2>
      <button (click)="handleNavigate('/add-organization')">
        <img src="./assets/images/organizations/add_circle.png" alt="">
        <p>დამატება</p>
      </button>
    </div>

    <form [formGroup]="myForm" class="organizations-filters">
      <div class="w-[100%] max-w-[390px] relative">
        <input
          type="text"
          pInputText
          formControlName="search"
          placeholder="სახელი / საიდენტიფიკაციო კოდი / მობილური ნომერი"
          class="text-left pl-10 "
        />
        
  <i class="pi pi-search absolute left-3 top-4" style="font-size: 1rem"></i>
      </div>

      <div class="w-[100%] max-w-[365px]">
        <p-calendar formControlName="date"
                    [dateFormat]="'yy-mm-dd'"
                    placeholder="თარიღი"
        ></p-calendar>
      </div>

      <div class="w-[100%] max-w-[365px]">
        <p-dropdown
          [options]="statusOptions"
        formControlName="status"
        optionLabel="name"
        placeholder="სტატუსი"
        />
      </div>
    </form>

    <div class="organizations__table" style="margin-top: 15px; overflow-x: auto;">
      <p-table
        *ngIf="organizations$ | async as orgData"
        [value]="orgData.data"
        [paginator]="false"
        [rows]="rowsPerPage"
        [rowsPerPageOptions]="[10, 25, 50]"
        (onPage)="onPageChange($event)"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      >
        <ng-template pTemplate="header">
          <tr style="padding-top: 10px;padding-bottom: 10px">
            <th style="width:16.6%;height:30px;font-size: 13px">დასახელება</th>
            <th style="width:16.6%;font-size: 13px">შპს</th>
            <th style="width:16.6%;font-size: 13px">საიდენტიფიკაციო კოდი</th>
            <th style="width:16.6%;font-size: 13px">სტატუსი</th>
            <th style="width:16.6%;font-size: 13px">შექმნის თარიღი</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-organization>
          <tr class="overflow-x-auto">
            <td style="height: 60px;">{{ organization.legalName }}</td>
            <td style="height: 60px;">{{ organization.tradeName }}</td>
            <td style="height: 60px;">{{ organization.identificationCode }}</td>
            <td style="height: 60px;">{{ organization.status }}</td>
            <td style="height: 60px;display: flex;align-items: center;justify-content: space-evenly">{{ organization.createdAt | date: 'dd/MM/yyyy' }}

              <i class="pi pi-eye" (click)="handleSpecificOrganizationClick('/specific-organization',organization.id)" style="color: #02B7FA;cursor: pointer"></i>
              <i (click)="handleEditClick('/edit-organizations',organization.id)" class="pi pi-pencil" style="color: #02B7FA;cursor: pointer"></i>
              <i class="pi pi-download" style="color: #02B7FA;cursor: pointer"></i>
            </td>
          </tr>
        </ng-template>
      </p-table>

      <div class="flex justify-center" >
        <p-paginator
          (onPageChange)="onPageChange($event)"
          [first]="first"
          [rows]="rowsPerPage"
          [totalRecords]="$totalRecords$()"
        />
      </div>
    </div>
  </div>
</div>
</div>
